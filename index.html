<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>News CMS</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Content Management System</h1>
        <nav>
            <ul>
                <li><a href="#">Home</a></li>
                <li><a href="#">Articles</a></li>
                <li><a href="#">Dashboard</a></li>
                <li><a href="#">Logout</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <section id="notifications"></section>
        <section id="searchBar">
            <input type="text" id="searchInput" placeholder="Search articles...">
            <button onclick="searchArticles()">Search</button>
        </section>
        <section id="filterOptions">
            <select id="statusFilter" onchange="filterArticles()">
                <option value="all">All</option>
                <option value="draft">Draft</option>
                <option value="published">Published</option>
            </select>
        </section>
        <section id="articles">
            <!-- Articles will be loaded here -->
        </section>
        <section id="pagination">
            <button onclick="loadMore()">Load More</button>
        </section>
    </main>
    <footer>
        <p>&copy; 2026 My CMS. All rights reserved.</p>
    </footer>
    <script>
        const supabaseUrl = process.env.SUPABASE_URL;
        const supabaseKey = process.env.SUPABASE_KEY;
        const { createClient } = supabase;
        const supabase = createClient(supabaseUrl, supabaseKey);

        async function fetchArticles() {
            // Fetch articles with error handling
            try {
                const { data: articles, error } = await supabase
                    .from('articles')
                    .select('*');
                if (error) throw error;
                renderArticles(articles);
            } catch (error) {
                showNotification('Error fetching articles: ' + error.message);
            }
        }

        function renderArticles(articles) {
            const articlesContainer = document.getElementById('articles');
            articlesContainer.innerHTML = '';
            articles.forEach(article => {
                const articleElement = document.createElement('div');
                articleElement.innerHTML = `<h2>${article.title}</h2><p>${article.description}</p><button onclick="togglePublish('${article.id}', '${article.status}')">${article.status}</button>`;
                articlesContainer.appendChild(articleElement);
            });
        }

        async function togglePublish(id, currentStatus) {
            const newStatus = currentStatus === 'published' ? 'draft' : 'published';
            const { error } = await supabase
                .from('articles')
                .update({ status: newStatus })
                .eq('id', id);
            if (error) {
                showNotification('Error updating article status: ' + error.message);
            } else {
                showNotification('Article status updated successfully!');
                fetchArticles();
            }
        }

        function showNotification(message) {
            const notifications = document.getElementById('notifications');
            notifications.innerHTML = `<div class='notification'>${message}</div>`;
            setTimeout(() => notifications.innerHTML = '', 3000);
        }
    </script>
</body>
</html>
